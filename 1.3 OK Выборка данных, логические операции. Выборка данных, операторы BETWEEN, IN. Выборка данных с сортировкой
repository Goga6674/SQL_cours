1. Выборка данных, логические операции
2. Выборка данных, операторы BETWEEN, IN
3. Выборка данных с сортировкой
4. Выборка данных, оператор LIKE


      1. Выборка данных, логические операции

 Логическое выражение после ключевого слова WHERE кроме операторов сравнения  и выражений может включать  логические операции (И «and», ИЛИ «or», НЕ «not») и круглые скобки, изменяющие приоритеты выполнения операций.
Приоритеты операций:
  1. круглые скобки
  2. умножение  (*),  деление (/)
  3. сложение  (+), вычитание (-)
  4. операторы сравнения (=, >, <, >=, <=, <>)
  5. NOT
  6. AND
  7. OR

Пример
Вывести название, автора и цену тех книг, которые написал Булгаков, ценой больше 600 рублей

Запрос:
      SELECT title, author, price 
      FROM book
      WHERE price > 600 AND author = 'Булгаков М.А.';

Результат:
+--------------------+---------------+--------+
| title              | author        | price  |
+--------------------+---------------+--------+
| Мастер и Маргарита | Булгаков М.А. | 670.99 |
+--------------------+---------------+--------+


Пример
Вывести название, цену  тех книг, которые написал Булгаков или Есенин, ценой больше 600 рублей

Запрос:
      SELECT title, author, price 
      FROM book
      WHERE (author = 'Булгаков М.А.' OR author = 'Есенин С.А.') AND price > 600;

Результат:
+-----------------------+---------------+--------+
| title                 | author        | price  |
+-----------------------+---------------+--------+
| Мастер и Маргарита    | Булгаков М.А. | 670.99 |
| Стихотворения и поэмы | Есенин С.А.   | 650.00 |
+-----------------------+---------------+--------+



            2. Выборка данных, операторы BETWEEN, IN

Логическое выражение после ключевого слова WHERE может включать операторы  BETWEEN и IN. Приоритет  у этих операторов такой же как у операторов сравнения, то есть они выполняются раньше, чем NOT, AND, OR.

Оператор BETWEEN позволяет отобрать данные, относящиеся к некоторому интервалу, включая его границы.

Пример
Выбрать названия и количества тех книг, количество которых от 5 до 14 включительно.

Запрос:
      SELECT title, amount 
      FROM book
      WHERE amount BETWEEN 5 AND 14;

Результат:
+---------------+--------+
| title         | amount |
+---------------+--------+
| Белая гвардия | 5      |
| Идиот         | 10     |
+---------------+--------+
Этот запрос можно реализовать по-другому, результат будет точно такой же.

SELECT title, amount 
FROM book
WHERE amount >= 5 AND amount <=14;
Оператор  IN  позволяет выбрать данные, соответствующие значениям из списка.

Пример

Выбрать названия и цены книг, написанных Булгаковым или Достоевским.

Запрос:
      SELECT title, price 
      FROM book
      WHERE author IN ('Булгаков М.А.', 'Достоевский Ф.М.');

Результат:
+--------------------+--------+
| title              | price  |
+--------------------+--------+
| Мастер и Маргарита | 670.99 |
| Белая гвардия      | 540.50 |
| Идиот              | 460.00 |
| Братья Карамазовы  | 799.01 |
+--------------------+--------+
Этот запрос можно реализовать по-другому, результат будет точно такой же.

SELECT title, price 
FROM book
WHERE author = 'Булгаков М.А.' OR author = 'Достоевский Ф.М.';


            3. Выборка данных с сортировкой


При выборке можно указывать столбец или несколько столбцов, по которым необходимо отсортировать отобранные строки. Для этого используются ключевые слова ORDER BY, после которых задаются имена столбцов. При этом строки сортируются по первому столбцу, если указан второй столбец, сортировка осуществляется только для тех строк, у которых значения первого столбца одинаковы. По умолчанию ORDER BY выполняет сортировку по возрастанию. Чтобы управлять направлением сортировки вручную, после имени столбца указывается ключевое слово ASC (по возрастанию) или DESC (по убыванию). 

Столбцы после ключевого слова ORDER BY можно задавать:
1 названием столбца;
2 номером столбца;
3 именем столбца (указанным после AS).

Пример
Вывести название, автора и цены книг. Информацию  отсортировать по названиям книг в алфавитном порядке.

Запрос:
      SELECT title, author, price
      FROM book
      ORDER BY title;

Результат:
+-----------------------+------------------+--------+
| title                 | author           | price  |
+-----------------------+------------------+--------+
| Белая гвардия         | Булгаков М.А.    | 540.50 |
| Братья Карамазовы     | Достоевский Ф.М. | 799.01 |
| Идиот                 | Достоевский Ф.М. | 460.00 |
| Мастер и Маргарита    | Булгаков М.А.    | 670.99 |
| Стихотворения и поэмы | Есенин С.А.      | 650.00 |
+-----------------------+------------------+--------+
Аналогичный результат получится при использовании запроса:

SELECT title, author, price
FROM book
ORDER BY 1;


Пример
Вывести автора, название и количество книг, в отсортированном в алфавитном порядке по автору и по убыванию количества, для тех книг, цены которых меньше 750 рублей.

Запрос:
      SELECT author, title, amount AS Количество
      FROM book
      WHERE price < 750
      ORDER BY author, amount DESC;
Результат:

+------------------+-----------------------+------------+
| author           | title                 | Количество |
+------------------+-----------------------+------------+
| Булгаков М.А.    | Белая гвардия         | 5          |
| Булгаков М.А.    | Мастер и Маргарита    | 3          |
| Достоевский Ф.М. | Идиот                 | 10         |
| Есенин С.А.      | Стихотворения и поэмы | 15         |
+------------------+-----------------------+------------+
Можно использовать другие варианты записи запроса:

SELECT author, title, amount AS Количество
FROM book
WHERE price < 750
ORDER BY author, Количество DESC;
SELECT author, title, amount AS Количество
FROM book
WHERE price < 750
ORDER BY 1, 3 DESC;
Важно! Если названия столбцов заключены в кавычки, то при использовании их в сортировке, необходимо записывать их БЕЗ КАВЫЧЕК.


            4. Выборка данных, оператор LIKE

Оператор LIKE используется для сравнения строк. В отличие от операторов отношения равно (=) и не равно (<>), LIKE позволяет сравнивать строки не на полное совпадение (не совпадение),
а в соответствии с шаблоном. Шаблон может включать обычные символы и символы-шаблоны. При сравнении с шаблоном, его обычные символы должны в точности совпадать с символами, указанными в строке. 
Символы-шаблоны могут совпадать с произвольными элементами символьной строки.

Символ-шаблон                  	Описание                                                         Пример
%                                   Любая строка, содержащая ноль или более символов                 SELECT * FROM book WHERE author LIKE '%М.%' выполняет поиск и выдает все книги, инициалы авторов которых содержат «М.» 

_ (подчеркивание)                   Любой одиночный символ                                           SELECT * FROM book WHERE title LIKE 'Поэм_' выполняет поиск и выдает все книги, названия которых либо «Поэма», либо «Поэмы» и пр.


Пример 1
Вывести названия книг, начинающихся с буквы «Б».

Запрос:
      SELECT title 
      FROM book
      WHERE title LIKE 'Б%';
      /* эквивалентное условие 
      title LIKE 'б%'
      */

Результат:
+-------------------+
| title             |
+-------------------+
| Белая гвардия     |
| Братья Карамазовы |
+-------------------+


Пример 2
Вывести название книг, состоящих ровно из 5 букв.

Запрос:
      SELECT title FROM book 
      WHERE title LIKE "_____"

Результат:
+-------+
| title |
+-------+
| Идиот |
| Поэмы |
+-------+

Пример 3
Вывести книги, название которых длиннее 5 символов:

Запрос:
      SELECT title FROM book 
      WHERE title LIKE "______%";
      /* эквивалентные условия 
      title LIKE "%______"
      title LIKE "%______%"
      */

Результат:
+-----------------------+
| title                 |
+-----------------------+
| Мастер и Маргарита    |
| Белая гвардия         |
| Братья Карамазовы     |
| Стихотворения и поэмы |
| Дети полуночи         |
| Лирика                |
| Капитанская дочка     |
+-----------------------+


Пример 4
Вывести названия книг, которые содержат букву "и" как отдельное слово, если считать, что слова в названии отделяются друг от друга пробелами и не содержат знаков препинания.

Запрос:
      SELECT title FROM book 
      WHERE   title LIKE "_% и _%" /*отбирает слово И внутри названия */
          OR title LIKE "и _%" /*отбирает слово И в начале названия */
          OR title LIKE "_% и" /*отбирает слово И в конце названия */
          OR title LIKE "и" /* отбирает название, состоящее из одного слова И */

Результат:
+-----------------------+
| title                 |
+-----------------------+
| Мастер и Маргарита    |
| Стихотворения и поэмы |
+-----------------------+


Пример 5
Вывести названия книг, которые состоят ровно из одного слова, если считать, что слова в названии отделяются друг от друга пробелами.

Запрос:
      SELECT title FROM book 
      WHERE title NOT LIKE "% %";    

Результат:
+--------+
| title  |
+--------+
| Идиот  |
| Лирика |
| Поэмы  |
+--------+
